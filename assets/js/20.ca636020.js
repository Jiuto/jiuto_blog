(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{387:function(t,a,s){"use strict";s.r(a);var e=s(44),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"如何使用docker发布项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何使用docker发布项目"}},[t._v("#")]),t._v(" 如何使用docker发布项目")]),t._v(" "),s("blockquote",[s("p",[t._v("本文将从docker的简单介绍，以及如何在docker上运行一个前端项目，讲到我曾经接触过的如何利用docker实现前端的自动化部署。")]),t._v(" "),s("p",[t._v("我对docker的了解也不深，只是基于自己的一丁点经验做一个前端发布的流程整理，同时帮助其他小白同学入门，如有错误，欢迎指正。")])]),t._v(" "),s("h3",{attrs:{id:"什么是docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是docker"}},[t._v("#")]),t._v(" 什么是docker")]),t._v(" "),s("blockquote",[s("p",[t._v("Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。")])]),t._v(" "),s("h4",{attrs:{id:"背景知识"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景知识"}},[t._v("#")]),t._v(" 背景知识")]),t._v(" "),s("p",[t._v("详细版传送门："),s("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker 入门教程-阮一峰"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("简化版：")]),t._v(" "),s("p",[t._v("大家都是开发者，知道配置环境的麻烦和难处，操作系统的设置、各种库和组件的安装，以及各个版本之间的兼容问题。")]),t._v(" "),s("p",[t._v("虚拟机是一种解决方案，但存在资源占用多、冗余步骤多、启动慢等缺点。")]),t._v(" "),s("p",[t._v("于是发展出来另一种虚拟化技术：Linux容器（Linux Containers，LXC）。LXC不模拟完整的操作系统，而是对进程进行隔离。由于容器是进程级别的，相比虚拟机启动快、资源占用少、体积小。")]),t._v(" "),s("h4",{attrs:{id:"镜像和容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#镜像和容器"}},[t._v("#")]),t._v(" 镜像和容器")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker"),s("OutboundLink")],1),t._v(" 将应用程序与该程序的依赖，打包在一个文件里面，这个文件称为一个image镜像，运行镜像文件，会生成一个container容器实例。我们的程序，就在这个容器实例中运行。")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"docker的一些基础命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker的一些基础命令"}},[t._v("#")]),t._v(" docker的一些基础命令")]),t._v(" "),s("blockquote",[s("p",[t._v("docker的安装这里就不讲了，大家自己去网上搜。")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker hub"),s("OutboundLink")],1),t._v("是docker的镜像仓库，我们可以在docker hub上搜索我们想要的镜像，比如nginx：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/dockerhub.png"),alt:"dockerhub"}}),t._v(" "),s("ul",[s("li",[s("p",[t._v("通过"),s("code",[t._v("docker pull nginx")]),t._v("命令，默认拉取最新版本的nginx镜像。在Tags列表中，我们也可以看到历史各个版本的镜像，通过"),s("code",[t._v(":")]),t._v("+"),s("code",[t._v("对应版本的tagName")]),t._v("获取指定版本的镜像。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker run")]),t._v("命令用于运行镜像，生成一个容器实例。")])]),t._v(" "),s("li",[s("p",[t._v("通过"),s("code",[t._v("docker ps -a")]),t._v("可以查看所有容器及其运行状态。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker start containName")]),t._v("运行容器。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker restart containName")]),t._v("重启容器。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker stop containName")]),t._v("停止运行容器。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker logs")]),t._v("查看容器输出日志。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker rm")]),t._v("删除指定容器。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker rmi")]),t._v("删除指定镜像。")])])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/run/",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker 命令列表"),s("OutboundLink")],1)]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"什么是dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是dockerfile"}},[t._v("#")]),t._v(" 什么是Dockerfile")]),t._v(" "),s("blockquote",[s("p",[t._v("A "),s("code",[t._v("Dockerfile")]),t._v(" is a text document that contains all the commands a user could call on the command line to assemble an image.")])]),t._v(" "),s("p",[t._v("Dockerfile是一个文本文件，包含了配置一个image镜像所有可以调用的命令。")]),t._v(" "),s("p",[t._v("这话其实有点歧义，实际上，并不是说它真的包含每一个命令，而是说当我们想要生成一个image镜像时，Docker会根据该文件中指定的命令，来生成二进制的 image 文件。")]),t._v(" "),s("h4",{attrs:{id:"举一个栗子🌰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#举一个栗子🌰"}},[t._v("#")]),t._v(" 举一个栗子🌰")]),t._v(" "),s("p",[s("strong",[t._v("场景")]),t._v("：在docker中运行mysql容器，希望免去初始化数据库的操作。")]),t._v(" "),s("p",[t._v("如果我们直接"),s("code",[t._v("docker pull mysql")]),t._v("，然后"),s("code",[t._v("docker run")]),t._v("，显然没有应用到我们的"),s("code",[t._v("init.sql")]),t._v("文件。")]),t._v(" "),s("p",[t._v("这个时候就可以写一个Dockerfile，来帮助我们构建一个想要的、直接完成初始化配置的镜像。")]),t._v(" "),s("p",[s("strong",[t._v("步骤")]),t._v("：夹带私货传送门："),s("a",{attrs:{href:"https://jiuto.github.io/jiuto_blog/guide/else/docker_initSql.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("通过Dockerfile在docker中初始化mysql表"),s("OutboundLink")],1)]),t._v(" "),s("ol",[s("li",[t._v("在当前docker命令行目录下，新建一个Dockerfile文件，代码如下：")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WORKDIR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("docker"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("entrypoint"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("initdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ENV")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LANG")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UTF")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ADD")]),t._v(" init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("​    其中，init.sql即mysql初始化需要执行的文件，需和Dockerfile文件在同一目录。")]),t._v(" "),s("p",[t._v("​\t这些命令是什么意思呢？大意就是基于mysql:5.7这个镜像，指定工作路径，设定环境变量，增加文件到指定目录。")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[t._v("在docker中通过"),s("code",[t._v("docker pull mysql:5.7")]),t._v("（以5.7版本为例）拉取mysql镜像，完成后通过"),s("code",[t._v("docker images")]),t._v("可查看image镜像列表。")])]),t._v(" "),s("li",[s("p",[t._v("在docker当前目录（Dockerfile所在目录）下执行"),s("code",[t._v("docker build -t mysql:5.7task .")]),t._v('构建tag名为"5.7task"的mysql镜像。')])]),t._v(" "),s("li",[s("p",[t._v("执行"),s("code",[t._v("docker run --name mysqltask -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7task")])])])]),t._v(" "),s("p",[t._v('​    运行名为"mysqltask"的容器，--name指定容器名，-p容器内部端口映射主机端口，-e设置环境变量，-d后台运行容器。')]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[s("p",[t._v("...")]),t._v(" "),s("p",[t._v("后面的步骤就不说了，到这里我们已经知道Dockerfile是什么了。")])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"如何用docker运行一个前端项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何用docker运行一个前端项目"}},[t._v("#")]),t._v(" 如何用docker运行一个前端项目")]),t._v(" "),s("p",[t._v("这个问题其实很简单，和docker没有太大关系，换一个nginx容器罢了。")]),t._v(" "),s("p",[t._v("将前端打包好的资源文件映射到容器的"),s("code",[t._v("/usr/share/nginx/html/")]),t._v("，再做好配置文件映射即可。")]),t._v(" "),s("p",[t._v("大家可以参考这篇文章，传送门："),s("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/02/nginx-docker.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx 容器教程-阮一峰"),s("OutboundLink")],1)]),t._v(" "),s("ol",[s("li",[s("p",[t._v("安装好docker之后，需要换源，可以通过"),s("a",{attrs:{href:"https://cr.console.aliyun.com/cn-beijing/instances/mirrors",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云容器镜像服务"),s("OutboundLink")],1),t._v("获取个人开发者的镜像加速器地址。（Docker toolbox无法用阿里云提供的方法，参考"),s("a",{attrs:{href:"https://www.cnblogs.com/cielosun/p/11113863.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker toolbox的换源"),s("OutboundLink")],1),t._v("）")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("docker pull nginx")]),t._v("拉取镜像，"),s("code",[t._v("docker images -a")]),t._v("查看镜像列表")])]),t._v(" "),s("li",[s("p",[t._v("建一个html demo："),s("code",[t._v("mkdir nginx-docker-demo")]),t._v("=>"),s("code",[t._v("cd nginx-docker-demo")]),t._v("=>"),s("code",[t._v("mkdir html")]),t._v("=>"),s("code",[t._v("vi index.html")]),t._v("=>i切换输入模式复制粘贴html，esc退出编辑，:底边命令，wq回车保存并退出")])])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token doctype"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),s("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-UA-Compatible"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("IE=edge"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width, initial-scale=1.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Document"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("docker nginx test"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[s("p",[s("code",[t._v("docker run --name nginx-test -p 8080:80 -d -v /Users/你的用户文件夹/nginx-docker-demo/html:/usr/share/nginx/html nginx")])])]),t._v(" "),s("li",[s("p",[t._v("打开"),s("code",[t._v("http://localhost:8080/")])])]),t._v(" "),s("li",[s("p",[t._v("如过想要更改配置，可以"),s("code",[t._v("docker cp nginx-test:/etc/nginx .")]),t._v("把容器的默认配置拷贝出来，运行容器的时候做好映射即可。")])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"我曾使用过的自动化部署流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#我曾使用过的自动化部署流程"}},[t._v("#")]),t._v(" 我曾使用过的自动化部署流程")]),t._v(" "),s("p",[t._v("我曾参与过一个使用"),s("a",{attrs:{href:"https://coding.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("coding"),s("OutboundLink")],1),t._v("进行管理的项目，这边简单介绍一下这个项目是如何完成自动化部署的。")]),t._v(" "),s("h4",{attrs:{id:"简单讲讲用coding持续集成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单讲讲用coding持续集成"}},[t._v("#")]),t._v(" 简单讲讲用coding持续集成")]),t._v(" "),s("p",[t._v("coding提供了很多构建计划的模版，可以直接使用，也可以自定义。")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/coding.png"),alt:"coding"}}),t._v(" "),s("p",[t._v("coding的持续集成帮我们做了哪些？")]),t._v(" "),s("p",[t._v("实际上，我们除了新增一个Dockerfile和构建节点，其余都由coding完成。")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/dockerfile.png"),alt:"dockerfile"}}),t._v(" "),s("p",[t._v("这个Dockerfile就不需要解释了，看一看构建的节点做了什么。")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/process1.png"),alt:"process1"}}),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/process2.png"),alt:"process2"}}),t._v(" "),s("h4",{attrs:{id:"在本地完成手动部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在本地完成手动部署"}},[t._v("#")]),t._v(" 在本地完成手动部署？")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/dc-ken-jiu/dc-deploy",target:"_blank",rel:"noopener noreferrer"}},[t._v("自动化部署工具(by Ken-ding)"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("在已完成镜像的前提下，这个工具使得我们只要在本地运行"),s("code",[t._v("npm run deploy")]),t._v("即可完成更新部署。")]),t._v(" "),s("p",[s("strong",[t._v("步骤")]),t._v("：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("首先当然是安装工具依赖")])]),t._v(" "),s("li",[s("p",[t._v("在项目根目录创建一个"),s("code",[t._v("deploy.js")]),t._v("文件，传入配置")])])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/deploy.png"),alt:"deploy"}}),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("在"),s("code",[t._v("package.json")]),t._v("中配置deploy命令：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deploy"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node deploy.js"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])])]),t._v(" "),s("p",[s("strong",[t._v("dc-deploy做了什么？")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/deployfun.png"),alt:"deployfun"}}),t._v(" "),s("p",[t._v("根据传入的配置完成打包-压缩-连接服务器-删除远程文件-上次文件-解压文件-查找容器。前面就不看了，看一下查找容器这一步。")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/imgs/else/docker/searchCon.png"),alt:"searchCon"}}),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("docker ps")]),t._v("查找容器，-q只显示容器编号，-f根据条件过滤显示的内容。")]),t._v(" "),s("p",[t._v("找到容器执行"),s("code",[t._v("docker restart")]),t._v("，没找到"),s("code",[t._v("docker run --name ${containName} -d -p ${exportPort}:80 -v ${webDir}:/usr/share/nginx/html -v ${webRootDir}/conf/nginx.conf:/etc/nginx/nginx.conf -v ${webRootDir}/conf.d:/etc/nginx/conf.d -v ${webRootDir}/logs:/var/log/nginx nginx")]),t._v("创建新容器。")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"结束语"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结束语"}},[t._v("#")]),t._v(" 结束语")]),t._v(" "),s("p",[t._v("这篇文章暂时就这样结束了，当然目的不是给大家介绍coding或是夹带私货，这些工具都不是重点，介绍他们的目的，只是为了让大家明白，用docker发布项目，本质上都是一样的：")]),t._v(" "),s("p",[t._v("不过是创建镜像并运行容器实例罢了。")])])}),[],!1,null,null,null);a.default=n.exports}}]);