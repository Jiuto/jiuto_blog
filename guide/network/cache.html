<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器缓存 | Jiuto&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/jiuto_blog/assets/css/0.styles.b6e0627a.css" as="style"><link rel="preload" href="/jiuto_blog/assets/js/app.32204389.js" as="script"><link rel="preload" href="/jiuto_blog/assets/js/2.36a0744b.js" as="script"><link rel="preload" href="/jiuto_blog/assets/js/41.eacc0525.js" as="script"><link rel="prefetch" href="/jiuto_blog/assets/js/10.d323d35b.js"><link rel="prefetch" href="/jiuto_blog/assets/js/11.ca2c251b.js"><link rel="prefetch" href="/jiuto_blog/assets/js/12.4c85ce06.js"><link rel="prefetch" href="/jiuto_blog/assets/js/13.b3a44604.js"><link rel="prefetch" href="/jiuto_blog/assets/js/14.934bf420.js"><link rel="prefetch" href="/jiuto_blog/assets/js/15.df4144b4.js"><link rel="prefetch" href="/jiuto_blog/assets/js/16.be7cc384.js"><link rel="prefetch" href="/jiuto_blog/assets/js/17.7fc8f218.js"><link rel="prefetch" href="/jiuto_blog/assets/js/18.6dc102f3.js"><link rel="prefetch" href="/jiuto_blog/assets/js/19.a99138ae.js"><link rel="prefetch" href="/jiuto_blog/assets/js/20.f6e7042a.js"><link rel="prefetch" href="/jiuto_blog/assets/js/21.6b19bbf2.js"><link rel="prefetch" href="/jiuto_blog/assets/js/22.397d9044.js"><link rel="prefetch" href="/jiuto_blog/assets/js/23.dc832852.js"><link rel="prefetch" href="/jiuto_blog/assets/js/24.a6618ff6.js"><link rel="prefetch" href="/jiuto_blog/assets/js/25.54e78843.js"><link rel="prefetch" href="/jiuto_blog/assets/js/26.9ad7d01a.js"><link rel="prefetch" href="/jiuto_blog/assets/js/27.d03cff72.js"><link rel="prefetch" href="/jiuto_blog/assets/js/28.667e826f.js"><link rel="prefetch" href="/jiuto_blog/assets/js/29.22fc176e.js"><link rel="prefetch" href="/jiuto_blog/assets/js/3.7e17ad15.js"><link rel="prefetch" href="/jiuto_blog/assets/js/30.a2fde92f.js"><link rel="prefetch" href="/jiuto_blog/assets/js/31.3b671c3b.js"><link rel="prefetch" href="/jiuto_blog/assets/js/32.8ac55a98.js"><link rel="prefetch" href="/jiuto_blog/assets/js/33.51b56568.js"><link rel="prefetch" href="/jiuto_blog/assets/js/34.6738dc58.js"><link rel="prefetch" href="/jiuto_blog/assets/js/35.f4cf9520.js"><link rel="prefetch" href="/jiuto_blog/assets/js/36.dbf3b95f.js"><link rel="prefetch" href="/jiuto_blog/assets/js/37.3d2ffe31.js"><link rel="prefetch" href="/jiuto_blog/assets/js/38.a3dfd2de.js"><link rel="prefetch" href="/jiuto_blog/assets/js/39.e3103822.js"><link rel="prefetch" href="/jiuto_blog/assets/js/4.e2dc8d0c.js"><link rel="prefetch" href="/jiuto_blog/assets/js/40.73671ee1.js"><link rel="prefetch" href="/jiuto_blog/assets/js/42.43a3d8b5.js"><link rel="prefetch" href="/jiuto_blog/assets/js/43.36fc0659.js"><link rel="prefetch" href="/jiuto_blog/assets/js/44.85c7b2da.js"><link rel="prefetch" href="/jiuto_blog/assets/js/45.fa791955.js"><link rel="prefetch" href="/jiuto_blog/assets/js/46.7cca8ef3.js"><link rel="prefetch" href="/jiuto_blog/assets/js/47.692c86fc.js"><link rel="prefetch" href="/jiuto_blog/assets/js/48.7524d1f0.js"><link rel="prefetch" href="/jiuto_blog/assets/js/49.2b31f495.js"><link rel="prefetch" href="/jiuto_blog/assets/js/5.81254301.js"><link rel="prefetch" href="/jiuto_blog/assets/js/50.516a9a6c.js"><link rel="prefetch" href="/jiuto_blog/assets/js/51.922c36a7.js"><link rel="prefetch" href="/jiuto_blog/assets/js/52.cb139a2f.js"><link rel="prefetch" href="/jiuto_blog/assets/js/53.5292a8e1.js"><link rel="prefetch" href="/jiuto_blog/assets/js/54.3fa7c5ad.js"><link rel="prefetch" href="/jiuto_blog/assets/js/6.3d7fe4d3.js"><link rel="prefetch" href="/jiuto_blog/assets/js/7.32f629af.js"><link rel="prefetch" href="/jiuto_blog/assets/js/8.bd998b8e.js"><link rel="prefetch" href="/jiuto_blog/assets/js/9.55e82eec.js">
    <link rel="stylesheet" href="/jiuto_blog/assets/css/0.styles.b6e0627a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/jiuto_blog/" class="home-link router-link-active"><!----> <span class="site-name">Jiuto's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/Jiuto" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/Jiuto" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/js/eventBus.html" class="sidebar-link">用Map写一个EventBus事件总线</a></li><li><a href="/jiuto_blog/guide/js/promise.html" class="sidebar-link">手写一个Promise</a></li><li><a href="/jiuto_blog/guide/js/babble_capture.html" class="sidebar-link">冒泡与捕获</a></li><li><a href="/jiuto_blog/guide/js/debounce_throttle.html" class="sidebar-link">防抖与节流</a></li><li><a href="/jiuto_blog/guide/js/clone.html" class="sidebar-link">浅拷贝和深拷贝</a></li><li><a href="/jiuto_blog/guide/js/module.html" class="sidebar-link">ES6 Module</a></li><li><a href="/jiuto_blog/guide/js/template.html" class="sidebar-link">模板引擎原理</a></li><li><a href="/jiuto_blog/guide/js/closure.html" class="sidebar-link">理解js闭包</a></li><li><a href="/jiuto_blog/guide/js/proto.html" class="sidebar-link">理解js原型、原型链和继承</a></li><li><a href="/jiuto_blog/guide/js/new.html" class="sidebar-link">手写 new 操作符</a></li><li><a href="/jiuto_blog/guide/js/bind.html" class="sidebar-link">手写 bind</a></li><li><a href="/jiuto_blog/guide/js/apply_call.html" class="sidebar-link">手写 apply 和 call</a></li><li><a href="/jiuto_blog/guide/js/let_const.html" class="sidebar-link">let、const和块级作用域</a></li><li><a href="/jiuto_blog/guide/js/curry.html" class="sidebar-link">柯里化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/css/flex.html" class="sidebar-link">flex布局</a></li><li><a href="/jiuto_blog/guide/css/layout.html" class="sidebar-link">常见布局</a></li><li><a href="/jiuto_blog/guide/css/bfc.html" class="sidebar-link">BFC 块格式化上下文</a></li><li><a href="/jiuto_blog/guide/css/stacking_context.html" class="sidebar-link">层叠上下文、层叠层级、层叠顺序</a></li><li><a href="/jiuto_blog/guide/css/center.html" class="sidebar-link">水平居中、垂直居中</a></li><li><a href="/jiuto_blog/guide/css/grid.html" class="sidebar-link">grid 网格布局</a></li><li><a href="/jiuto_blog/guide/css/css3.html" class="sidebar-link">CSS3 动画</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/vue/nextTick.html" class="sidebar-link">vue中$nextTick的实现原理</a></li><li><a href="/jiuto_blog/guide/vue/responsive.html" class="sidebar-link">简单实现vue响应式原理</a></li><li><a href="/jiuto_blog/guide/vue/initData.html" class="sidebar-link">源码分析vue响应式原理</a></li><li><a href="/jiuto_blog/guide/vue/initWatch.html" class="sidebar-link">源码分析vue watch侦听器</a></li><li><a href="/jiuto_blog/guide/vue/patch.html" class="sidebar-link">源码阅读vue VirtualDOM 和 diff</a></li><li><a href="/jiuto_blog/guide/vue/initComputed.html" class="sidebar-link">源码分析vue computed</a></li><li><a href="/jiuto_blog/guide/vue/router.html" class="sidebar-link">源码阅读vue-router</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/webpack/webpack_template.html" class="sidebar-link">webpack多页面打包方法工具和模板</a></li><li><a href="/jiuto_blog/guide/webpack/babeltry.html" class="sidebar-link">通过babel手撸超简化版webpack</a></li><li><a href="/jiuto_blog/guide/webpack/plugin_loader.html" class="sidebar-link">手写webpack plugin 和 loader</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/browser/eventloop.html" class="sidebar-link">event loop 事件循环</a></li><li><a href="/jiuto_blog/guide/browser/render.html" class="sidebar-link">浏览器渲染机制</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>网络与安全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/network/http.html" class="sidebar-link">http、https</a></li><li><a href="/jiuto_blog/guide/network/cache.html" aria-current="page" class="active sidebar-link">浏览器缓存</a></li><li><a href="/jiuto_blog/guide/network/cross.html" class="sidebar-link">跨域</a></li><li><a href="/jiuto_blog/guide/network/security.html" class="sidebar-link">web 安全</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiuto_blog/guide/else/ele_expend.html" class="sidebar-link">如何在element-ui中拓展一个新的组件</a></li><li><a href="/jiuto_blog/guide/else/cli.html" class="sidebar-link">搭建一个脚手架工具</a></li><li><a href="/jiuto_blog/guide/else/utils.html" class="sidebar-link">搭建一个方法库</a></li><li><a href="/jiuto_blog/guide/else/auto_deploy.html" class="sidebar-link">搭建一个自动化部署服务</a></li><li><a href="/jiuto_blog/guide/else/docker_verdaccio.html" class="sidebar-link">在docker中通过Verdaccio搭建一个私有npm库</a></li><li><a href="/jiuto_blog/guide/else/docker_initSql.html" class="sidebar-link">通过Dockerfile在docker中初始化mysql表</a></li><li><a href="/jiuto_blog/guide/else/eslint_prettier.html" class="sidebar-link">在vue/react项目中配置eslint + prettier</a></li><li><a href="/jiuto_blog/guide/else/karma_mocha.html" class="sidebar-link">搭建一个由 karma + mocha + chai + Istanbul 组成的基础测试工具</a></li><li><a href="/jiuto_blog/guide/else/optimization.html" class="sidebar-link">首屏加载优化</a></li><li><a href="/jiuto_blog/guide/else/interview.html" class="sidebar-link">面试路漫漫</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="浏览器缓存"><a href="#浏览器缓存" class="header-anchor">#</a> 浏览器缓存</h2> <h3 id="什么是浏览器缓存"><a href="#什么是浏览器缓存" class="header-anchor">#</a> 什么是浏览器缓存</h3> <blockquote><p>浏览器缓存保存着用户通过 HTTP 获取的所有资源，再下一次请求时可以避免重复向服务器发出多余的请求。</p></blockquote> <p>浏览器缓存也就http缓存，分为强制缓存和协商缓存，两类缓存可同时存在，但强制缓存优先级更高。</p> <p>为什么使用缓存：</p> <ol><li>避免数据重复传递，节省宽带流量</li> <li>减少服务器的负担，提高网站性能</li> <li>加快网页加载速度</li></ol> <h3 id="强制缓存"><a href="#强制缓存" class="header-anchor">#</a> 强制缓存</h3> <p>当本地缓存中有所请求的数据时，客户端直接从缓存中获取数据，当缓存中没有所请求的数据时，客户端从服务端获取新的数据，并更新缓存。</p> <p>通过服务器响应header中的Expires和Cache-Control字段设置。</p> <ul><li>Exprires</li></ul> <p>Exprires的值为缓存到期时间，是一个绝对时间。</p> <p>缺点：</p> <p>服务端和客户端时间不一致，会导致缓存命中的误差，如果手动更改了客户端的本地时间，也可能导致错误判断缓存失效。</p> <blockquote><p>Expires是HTTP1.0的产物，故现在大多数使用Cache-Control替代。</p></blockquote> <ul><li>Cache-Control</li></ul> <p>Cache-Control通过max-age设置一个相对时间，如<code>Cache-Control:max-age=600</code>，单位是秒，表示600s后缓存过期。</p> <p>其他属性：</p> <ol><li><p>no-cache：需要进行协商缓存，发送请求到服务器确认是否使用缓存。</p></li> <li><p>no-store：禁止使用缓存，每一次都要重新请求数据。</p></li> <li><p>public：默认设置，客户端和代理服务器都可以缓存。</p></li> <li><p>private：不能被多用户共享，客户端可以缓存。</p></li></ol> <blockquote><p>现在基本上都会同时设置 Expire 和 Cache-Control ，Cache-Control 的优先级别更高。</p></blockquote> <h3 id="协商缓存-对比缓存"><a href="#协商缓存-对比缓存" class="header-anchor">#</a> 协商缓存（对比缓存）</h3> <p>客户端先从本地缓存中获取缓存数据的标识，然后向服务端发起请求验证缓存是否失效，未失效返回304并显示&quot;Not Modified&quot;，从缓存中获取数据，如果失效返回200和新数据，更新缓存。</p> <ul><li>Last-Modified、if-Modified-Since/if-Unmodified-Since</li></ul> <p>Last-Modified：</p> <p>浏览器第一次请求资源的时候，服务器返回的header上会返回Last-Modified字段，表示资源最后修改的时间。</p> <p>if-Modified-Since：</p> <p>浏览器再次请求该资源时，请求的header会包含if-Modified-Since字段，表示缓存中获得的最后修改时间，也就是浏览器返回header的Last-Modified。</p> <p>服务端接收到请求，将if-Modified-Since与资源的最后修改时间进行对比，如果一致返回304和&quot;Not Modified&quot;，浏览器从缓存中获取数据，如果不一致，返回200和新资源，浏览器更新缓存。</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-Unmodified-Since" target="_blank" rel="noopener noreferrer">if-Unmodified-Since<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <blockquote><p>HTTP协议中的 If-Unmodified-Since 消息头用于请求之中，使得当前请求成为条件式请求：
只有当资源在指定的时间之后没有进行过修改的情况下，服务器才会返回请求的资源，或是接受 POST 或其他 non-safe 方法的请求。
如果所请求的资源在指定的时间之后发生了修改，那么会返回 412 (Precondition Failed) 错误。</p></blockquote> <p>即，if-Modified-Since是资源修改才返回，if-Unmodified-Since是资源没修改才返回。</p> <p>缺点：</p> <ol><li><p>最小单位是秒，如果短时间内资源发生了改变，Last-Modified返回的时间并不精确。</p></li> <li><p>文件修改时间发生变化，但实际内容没有变化，无法检测到。</p></li></ol> <p>因此推出了Etag。</p> <ul><li>Etag、If-no-match</li></ul> <p>Etag 字段的值表示资源的唯一标识，一般是由文件内容 hash 生成的。</p> <p>在浏览器第一次请求资源时，服务器会返回一个 Etag 标识。</p> <p>再次请求该资源时，请求头中包含If-no-match字段表示上一次请求的Etag值，服务器比较后，如果一致，返回304，如果不一致，返回新资源并更新缓存。</p> <blockquote><p>实际应用中Etag生成算法会占用服务端的资源。</p> <p>Last-Modified 和 Etag 是可以同时设置的，服务器会优先校验 Etag，如果 Etag 相等就会继续比对 Last-Modified，最后才会决定是否返回 304。</p></blockquote> <h3 id="不同刷新请求的执行过程"><a href="#不同刷新请求的执行过程" class="header-anchor">#</a> 不同刷新请求的执行过程</h3> <p>浏览器中输入URL确认跳转，发现缓存有该资源，直接从缓存获取。</p> <p>F5刷新，<code>强制缓存 || 协商缓存 ? 使用缓存 : 返回最新的资源</code>。</p> <p>Ctrl+F5强制刷新，浏览器删除缓存中的资源，向服务器重新请求。</p> <h3 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h3> <p><a href="https://mp.weixin.qq.com/s/Wvc0lkLpgyEW_u7bbMdvpQ" target="_blank" rel="noopener noreferrer">关于浏览器缓存你知道多少<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6844903517702848526" target="_blank" rel="noopener noreferrer">HTTP----HTTP缓存机制<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/jiuto_blog/guide/network/http.html" class="prev">
        http、https
      </a></span> <span class="next"><a href="/jiuto_blog/guide/network/cross.html">
        跨域
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/jiuto_blog/assets/js/app.32204389.js" defer></script><script src="/jiuto_blog/assets/js/2.36a0744b.js" defer></script><script src="/jiuto_blog/assets/js/41.eacc0525.js" defer></script>
  </body>
</html>
